<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå Sarabun ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö */
        * {
            font-family: 'Sarabun', sans-serif;
        }
        
        /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô Fade In */
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô Slide Up */
        .slide-up {
            animation: slideUp 0.6s ease-out;
        }
        
        /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô Bounce In */
        .bounce-in {
            animation: bounceIn 0.8s ease-out;
        }
        
        /* ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ü‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Fade In */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ü‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Slide Up */
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ü‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Bounce In */
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
        .tab-content {
            display: none;
        }
        
        /* ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏ó‡πá‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà */
        .tab-content.active {
            display: block;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô */
        .calendar-day {
            min-height: 100px;
            border: 1px solid #e5e7eb;
            position: relative;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á */
        .calendar-day.has-booking {
            background: linear-gradient(135deg, #fecaca, #fef2f2);
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á */
        .booking-indicator {
            font-size: 10px;
            padding: 2px 4px;
            border-radius: 4px;
            margin: 1px 0;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ Modal */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            max-height: 80vh; /* ‡πÄ‡∏û‡∏¥‡πà‡∏° max-height */
            overflow-y: auto; /* ‡πÄ‡∏û‡∏¥‡πà‡∏° overflow-y: auto */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-red-50 to-pink-50 min-h-screen">
    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß (Header) -->
    <header class="bg-white shadow-lg border-b-4 border-red-200 fade-in">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <img src="https://img2.pic.in.th/pic/logo-HDR.md.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="h-16 w-auto bounce-in">
                <div class="text-center flex-1 mx-8">
                    <h1 class="text-2xl md:text-4xl font-bold text-red-600 mb-2 slide-up">
                        üìÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà üè´
                    </h1>
                    <p class="text-lg text-red-400 font-medium slide-up" style="animation-delay: 0.2s;">
                        ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏≤‡∏á‡∏î‡∏á‡∏£‡∏±‡∏ê‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå
                    </p>
                </div>
            </div>
        </div>
    </header>

    <!-- ‡πÅ‡∏ñ‡∏ö‡∏ô‡∏≥‡∏ó‡∏≤‡∏á (Navigation Tabs) -->
    <nav class="bg-white shadow-md border-b-2 border-red-100 sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex space-x-0">
                <button onclick="showTab('booking', this)" class="tab-btn flex-1 py-4 px-6 text-center font-semibold text-red-600 border-b-3 border-red-500 bg-red-50 transition-all duration-300">
                    üìù ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                </button>
                <button onclick="showTab('calendar', this)" class="tab-btn flex-1 py-4 px-6 text-center font-semibold text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-300">
                    üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                </button>
                <button onclick="showTab('statistics', this)" class="tab-btn flex-1 py-4 px-6 text-center font-semibold text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-300">
                    üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </button>
            </div>
        </div>
    </nav>

    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å (Main Content) -->
    <main class="container mx-auto px-4 py-8">
        <!-- ‡πÅ‡∏ó‡πá‡∏ö 1: ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á (Booking Form) -->
        <div id="booking" class="tab-content active">
            <div class="bg-white rounded-xl shadow-lg p-8 slide-up">
                <h2 class="text-2xl font-bold text-red-600 mb-6 text-center">
                    ‚úçÔ∏è ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                </h2>
                
                <form id="bookingForm" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á *
                            </label>
                            <input type="text" id="fullName" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ *
                            </label>
                            <input type="tel" id="phone" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            üè¢ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Ø *
                        </label>
                        <select id="department" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</option>
                            <option value="‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£">‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                            <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                            <option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
                            <option value="‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£">‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                            <option value="‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô">‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</option>
                            <option value="‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</option>
                            <option value="‡∏®‡∏¥‡∏•‡∏õ‡∏∞">‡∏®‡∏¥‡∏•‡∏õ‡∏∞</option>
                            <option value="‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                            <option value="‡∏™‡∏∏‡∏Ç‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏™‡∏∏‡∏Ç‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                            <option value="‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</option>
                            <option value="‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°">‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏®‡∏≤‡∏™‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°</option>
                            <option value="‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û">‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</option>
                            <option value="‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®">‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *
                        </label>
                        <select id="purpose" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</option>
                            <option value="‡∏à‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡∏à‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            <option value="‡∏à‡∏±‡∏î‡∏≠‡∏ö‡∏£‡∏°">‡∏à‡∏±‡∏î‡∏≠‡∏ö‡∏£‡∏°</option>
                            <option value="‡∏à‡∏±‡∏î‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤">‡∏à‡∏±‡∏î‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤</option>
                            <option value="‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£">‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô">‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                        <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏™‡∏°‡∏≠ -->
                        <input type="text" id="purposeDetail" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors mt-2">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            üèõÔ∏è ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *
                        </label>
                        <select id="location" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 1">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 1</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 3">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏™‡∏ï‡∏ó‡∏±‡∏®‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 3</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏ù‡∏∏‡πà‡∏ô">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏ù‡∏∏‡πà‡∏ô</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏áTGT">‡∏´‡πâ‡∏≠‡∏áTGT</option>
                            <option value="‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÅ‡∏°‡πà‡∏ó‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏á">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÅ‡∏°‡πà‡∏ó‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏á</option>
                            <option value="‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ô">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ô</option>
                            <option value="‡∏•‡∏≤‡∏ô Play and Learn">‡∏•‡∏≤‡∏ô Play and Learn</option>
                            <option value="‡∏™‡∏ô‡∏≤‡∏°‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•">‡∏™‡∏ô‡∏≤‡∏°‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏ß‡∏ô‡∏û‡∏§‡∏Å‡∏©‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏ß‡∏ô‡∏û‡∏§‡∏Å‡∏©‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                        </select>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á *
                            </label>
                            <input type="date" id="bookingDate" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                üïê ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° *
                            </label>
                            <input type="time" id="startTime" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                üïê ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î *
                            </label>
                            <input type="time" id="endTime" required class="w-full px-4 py-3 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            üé§ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
                        </label>
                        <div class="grid md:grid-cols-2 gap-4">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="equipment" value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á" class="w-4 h-4 text-red-600">
                                <span>üîä ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="equipment" value="projector" class="w-4 h-4 text-red-600">
                                <span>üìΩÔ∏è Projector</span>
                            </label>
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" name="equipment" value="‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡∏°‡∏µ‡∏™‡∏≤‡∏¢" class="w-4 h-4 text-red-600">
                                <span>üé§ ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡∏°‡∏µ‡∏™‡∏≤‡∏¢</span>
                                <input type="number" id="wiredMicCount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" class="w-20 px-2 py-1 border border-red-200 rounded text-sm">
                            </div>
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" name="equipment" value="‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢" class="w-4 h-4 text-red-600">
                                <span>üìª ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢</span>
                                <input type="number" id="wirelessMicCount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" class="w-20 px-2 py-1 border border-red-200 rounded text-sm">
                            </div>
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" name="equipment" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="w-4 h-4 text-red-600">
                                <span>üì¶ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                                <input type="text" id="otherEquipment" placeholder="‡∏£‡∏∞‡∏ö‡∏∏" class="flex-1 px-2 py-1 border border-red-200 rounded text-sm">
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="bg-gradient-to-r from-red-500 to-pink-500 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:from-red-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ‡πÅ‡∏ó‡πá‡∏ö 2: ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô (Calendar View) -->
        <div id="calendar" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-red-600">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
                    <div class="flex items-center space-x-4">
                        <button onclick="previousMonth()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">‚óÄ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>
                        <span id="currentMonth" class="text-lg font-semibold text-red-600"></span>
                        <button onclick="nextMonth()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ñ∂</button>
                    </div>
                </div>
                
                <div id="calendarGrid" class="grid grid-cols-7 gap-1 mb-8">
                    <!-- ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
                
                <div class="mt-8">
                    <div class="flex flex-wrap items-center gap-4 mb-4">
                        <h3 class="text-xl font-bold text-red-600">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                        <input type="date" id="bookingFilterDate" class="px-4 py-2 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors">
                        <button onclick="filterBookingsByDate()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        <button onclick="clearBookingFilter()" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
                    </div>
                    <div id="bookingTable" class="space-y-6">
                        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ‡πÅ‡∏ó‡πá‡∏ö 3: ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (Statistics) -->
        <div id="statistics" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-red-600 mb-6 text-center">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
                
                <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á -->
                <div class="flex flex-wrap items-center justify-center gap-4 mb-8">
                    <div>
                        <label for="filterYear" class="block text-sm font-semibold text-gray-700 mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ:</label>
                        <select id="filterYear" class="w-full px-4 py-2 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors" onchange="updateStatistics()">
                            <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                        </select>
                    </div>
                    <div>
                        <label for="filterMonth" class="block text-sm font-semibold text-gray-700 mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
                        <select id="filterMonth" class="w-full px-4 py-2 border-2 border-red-200 rounded-lg focus:border-red-500 focus:outline-none transition-colors" onchange="updateStatistics()">
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="0">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                            <option value="1">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                            <option value="2">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                            <option value="3">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                            <option value="4">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                            <option value="5">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                            <option value="6">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                            <option value="7">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                            <option value="8">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                            <option value="9">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                            <option value="10">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                            <option value="11">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                        </select>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-red-600 mb-4">üìà ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
                        <canvas id="monthlyChart" width="400" height="200"></canvas>
                    </div>
                    
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-red-600 mb-4">üè¢ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</h3>
                        <canvas id="departmentChart" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-red-600 mb-4">üèõÔ∏è ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                        <canvas id="locationChart" width="400" height="200"></canvas>
                    </div>
                    
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-red-600 mb-4">üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                        <canvas id="purposeChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Success Modal) -->
    <div id="successModal" class="modal">
        <div class="modal-content text-center">
            <div class="text-6xl mb-4">‚úÖ</div>
            <h3 class="text-2xl font-bold text-green-600 mb-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <p class="text-gray-600 mb-6">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
            <button onclick="closeModal()" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors">
                ‡∏ï‡∏Å‡∏•‡∏á
            </button>
        </div>
    </div>

    <!-- Modal ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á (Booking Details Modal) -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-red-600">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
                <button onclick="closeBookingModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="bookingDetails"></div>
        </div>
    </div>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢ (Footer) -->
    <footer class="bg-white border-t-4 border-red-200 mt-16 py-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-red-600 font-medium">
                üë• ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏≤‡∏á‡∏î‡∏á‡∏£‡∏±‡∏ê‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå üè´
            </p>
        </div>
    </footer>

    <script>
        // Global variables
        let currentDate = new Date();
        let bookings = [];
        // URL of your deployed Google Apps Script
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw9n29jxMgK-LXnFammfd0AD7hjp3evu_lKh7s-Z1wt6YZxegr9bQPBU5zB5phFzQ/exec'; // Replace with your URL

        // Chart colors
        const CHART_COLORS = [
            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40',
            '#E7E9ED', '#8AC926', '#FFCA3A', '#1982C4', '#6A4C93', '#F45B69',
            '#5B84B1', '#C1B4A6', '#C70039', '#FFC300', '#DAF7A6', '#FF5733',
            '#C70039', '#900C3F', '#581845', '#FFC300', '#FF5733', '#C70039'
        ];

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            loadBookings(); // Load booking data
            generateCalendar(); // Generate calendar
            setupFilterOptions(); // Set up filter options
            updateStatistics(); // Update statistics
            
            // Set minimum date in the booking form to today
            document.getElementById('bookingDate').min = new Date().toISOString().split('T')[0];
            // Set minimum date for the booking filter to today
            document.getElementById('bookingFilterDate').min = new Date().toISOString().split('T')[0];
        });

        // Function to switch tabs
        function showTab(tabName, clickedButton) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-red-500', 'bg-red-50', 'text-red-600');
                btn.classList.add('text-gray-600');
            });
            
            // Show the selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to the clicked button
            clickedButton.classList.add('border-red-500', 'bg-red-50', 'text-red-600');
            clickedButton.classList.remove('text-gray-600');
            
            // Refresh content based on tab
            if (tabName === 'calendar') {
                generateCalendar();
                generateBookingTable(); // Call without filter initially
            } else if (tabName === 'statistics') {
                updateStatistics();
            }
        }

        // Function to toggle display of additional purpose input
        function togglePurposeInput() {
            // No longer needed as purposeDetail is always visible and required
            // const purpose = document.getElementById('purpose').value;
            // const purposeDetail = document.getElementById('purposeDetail');
            
            // if (purpose === '‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£' || purpose === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
            //     purposeDetail.classList.remove('hidden');
            //     purposeDetail.required = true;
            // } else {
            //     purposeDetail.classList.add('hidden');
            //     purposeDetail.required = false;
            //     purposeDetail.value = '';
            // }
        }

        // Form submission
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading status
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            submitBtn.disabled = true;
            
            const bookingData = {
                fullName: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                department: document.getElementById('department').value,
                purpose: document.getElementById('purpose').value,
                purposeDetail: document.getElementById('purposeDetail').value, // Always capture purposeDetail
                location: document.getElementById('location').value,
                bookingDate: document.getElementById('bookingDate').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                equipment: getSelectedEquipment()
            };

            // Validate time
            if (bookingData.startTime >= bookingData.endTime) {
                // Replace alert() with displaying message in a modal or other element
                showCustomAlert('‚ö†Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                return;
            }

            // Check for conflicts
            if (hasTimeConflict(bookingData)) {
                // Replace alert() with displaying message in a modal or other element
                showCustomAlert('‚ö†Ô∏è ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                return;
            }

            try {
                // Send data to Google Apps Script
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Use no-cors mode for Google Apps Script
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addBooking',
                        data: bookingData
                    })
                });

                // Since no-cors mode is used, it will be considered successful
                // Add booking to local array to update UI immediately
                bookings.push(bookingData);
                
                // Show success modal
                document.getElementById('successModal').style.display = 'block';
                
                // Reset form
                this.reset();
                // document.getElementById('purposeDetail').classList.add('hidden'); // No longer hide
                
                // Refresh display
                generateCalendar();
                generateBookingTable();
                updateStatistics();
                
            } catch (error) {
                console.error('Error:', error);
                // Replace alert() with displaying message in a modal or other element
                showCustomAlert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            } finally {
                // Reset button status
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Function to get selected equipment
        function getSelectedEquipment() {
            const equipment = [];
            const checkboxes = document.querySelectorAll('input[name="equipment"]:checked');
            
            checkboxes.forEach(checkbox => {
                let equipmentText = checkbox.value;
                
                if (checkbox.value === '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡∏°‡∏µ‡∏™‡∏≤‡∏¢') {
                    const count = document.getElementById('wiredMicCount').value;
                    if (count) equipmentText += ` (${count} ‡∏ï‡∏±‡∏ß)`;
                } else if (checkbox.value === '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢') {
                    const count = document.getElementById('wirelessMicCount').value;
                    if (count) equipmentText += ` (${count} ‡∏ï‡∏±‡∏ß)`;
                } else if (checkbox.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    const detail = document.getElementById('otherEquipment').value;
                    if (detail) equipmentText += ` (${detail})`;
                }
                
                equipment.push(equipmentText);
            });
            
            return equipment.join(', ');
        }

        // Function to check for time conflicts
        function hasTimeConflict(newBooking) {
            return bookings.some(booking => {
                return booking.location === newBooking.location &&
                       booking.bookingDate === newBooking.bookingDate &&
                       ((newBooking.startTime >= booking.startTime && newBooking.startTime < booking.endTime) ||
                        (newBooking.endTime > booking.startTime && newBooking.endTime <= booking.endTime) ||
                        (newBooking.startTime <= booking.startTime && newBooking.endTime >= booking.endTime));
            });
        }

        // Function to load booking data from Google Sheets
        async function loadBookings() {
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getBookings`);
                // Check if response.ok is true before attempting to read JSON
                if (response.ok) {
                    bookings = await response.json();
                } else {
                    console.error('Failed to load bookings:', response.status, response.statusText);
                    // If unsuccessful, set bookings to an empty array or handle the error appropriately
                    bookings = []; 
                }
            } catch (error) {
                console.error('Error loading bookings:', error);
                bookings = []; // In case of connection error
            }
        }

        // Calendar function
        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Update month display
            const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                              '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year + 543}`;
            
            // Create calendar grid
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            let calendarHTML = '';
            
            // Day headers
            const dayHeaders = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];
            dayHeaders.forEach(day => {
                calendarHTML += `<div class="text-center font-semibold text-red-600 py-2 bg-red-50">${day}</div>`;
            });
            
            // Empty cells for days before the start of the month
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day"></div>';
            }
            
            // Days in the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayBookings = bookings.filter(booking => booking.bookingDate === dateStr);
                
                let dayClass = 'calendar-day';
                let bookingIndicators = '';
                
                if (dayBookings.length > 0) {
                    dayClass += ' has-booking cursor-pointer';
                    dayBookings.forEach(booking => {
                        bookingIndicators += `<div class="booking-indicator bg-red-200 text-red-800 text-xs rounded">${booking.startTime}-${booking.endTime} ${booking.location}</div>`;
                    });
                }
                
                calendarHTML += `
                    <div class="${dayClass}" onclick="showDayBookings('${dateStr}')">
                        <div class="font-semibold text-gray-700 mb-1">${day}</div>
                        ${bookingIndicators}
                    </div>
                `;
            }
            
            document.getElementById('calendarGrid').innerHTML = calendarHTML;
        }

        // Function to go to the previous month
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
            generateBookingTable();
        }

        // Function to go to the next month
        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
            generateBookingTable();
        }

        // Function to show bookings for a specific day
        function showDayBookings(dateStr) {
            const dayBookings = bookings.filter(booking => booking.bookingDate === dateStr);
            
            if (dayBookings.length === 0) return;
            
            let detailsHTML = `<h4 class="font-semibold text-red-600 mb-4">üìÖ ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formatThaiDate(dateStr)}</h4>`;
            
            dayBookings.forEach(booking => {
                detailsHTML += `
                    <div class="border-l-4 border-red-300 pl-4 mb-4 bg-red-50 p-4 rounded">
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><strong>üë§ ‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</strong> ${booking.fullName}</div>
                            <div><strong>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> ${booking.phone}</div>
                            <div><strong>üè¢ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô:</strong> ${booking.department}</div>
                            <div><strong>üïê ‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${booking.startTime} - ${booking.endTime}</div>
                            <div class="col-span-2"><strong>üèõÔ∏è ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${booking.location}</div>
                            <div class="col-span-2"><strong>üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> ${booking.purpose}${booking.purposeDetail ? ' (' + booking.purposeDetail + ')' : ''}</div>
                            ${booking.equipment ? `<div class="col-span-2"><strong>üé§ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${booking.equipment}</div>` : ''}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('bookingDetails').innerHTML = detailsHTML;
            document.getElementById('bookingModal').style.display = 'block';
        }

        // Function to generate booking table with optional date filter
        function generateBookingTable(filterDate = null) {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const monthStart = new Date(year, month, 1);
            const monthEnd = new Date(year, month + 1, 0);
            
            let monthBookings = bookings.filter(booking => {
                const bookingDate = new Date(booking.bookingDate);
                return bookingDate >= monthStart && bookingDate <= monthEnd;
            });

            // Apply date filter if provided
            if (filterDate) {
                monthBookings = monthBookings.filter(booking => booking.bookingDate === filterDate);
            }
            
            // Group by location
            const locationGroups = {};
            monthBookings.forEach(booking => {
                if (!locationGroups[booking.location]) {
                    locationGroups[booking.location] = [];
                }
                locationGroups[booking.location].push(booking);
            });
            
            let tableHTML = '';
            
            Object.keys(locationGroups).sort().forEach(location => {
                const locationBookings = locationGroups[location].sort((a, b) => {
                    if (a.bookingDate !== b.bookingDate) {
                        return new Date(a.bookingDate) - new Date(b.bookingDate);
                    }
                    return a.startTime.localeCompare(b.startTime);
                });
                
                tableHTML += `
                    <div class="bg-red-50 rounded-lg p-4">
                        <h4 class="font-semibold text-red-600 mb-3">üèõÔ∏è ${location}</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="bg-red-100">
                                        <th class="px-3 py-2 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                                        <th class="px-3 py-2 text-left">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
                                        <th class="px-3 py-2 text-left">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                        <th class="px-3 py-2 text-left">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                locationBookings.forEach(booking => {
                    tableHTML += `
                        <tr class="border-b border-red-200">
                            <td class="px-3 py-2">${formatThaiDate(booking.bookingDate)}</td>
                            <td class="px-3 py-2">${booking.fullName}</td>
                            <td class="px-3 py-2">${booking.startTime} - ${booking.endTime}</td>
                            <td class="px-3 py-2">${booking.purpose}</td>
                        </tr>
                    `;
                });
                
                tableHTML += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('bookingTable').innerHTML = tableHTML || '<p class="text-gray-500 text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>';
        }

        // Function to filter bookings by date
        function filterBookingsByDate() {
            const filterDate = document.getElementById('bookingFilterDate').value;
            generateBookingTable(filterDate);
        }

        // Function to clear booking filter
        function clearBookingFilter() {
            document.getElementById('bookingFilterDate').value = '';
            generateBookingTable(); // Regenerate table without filter
        }


        // Function to set up year and month filter options
        function setupFilterOptions() {
            const filterYearSelect = document.getElementById('filterYear');
            const currentYear = new Date().getFullYear();
            
            // Add year options (from 5 years ago to 1 year in the future)
            for (let i = currentYear - 5; i <= currentYear + 1; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i + 543; // Convert to Buddhist year
                if (i === currentYear) {
                    option.selected = true;
                }
                filterYearSelect.appendChild(option);
            }
        }

        // Function to update statistics
        function updateStatistics() {
            const selectedYear = parseInt(document.getElementById('filterYear').value);
            const selectedMonth = document.getElementById('filterMonth').value; // 'all' or month index (0-11)

            // Filter booking data by selected year and month
            const filteredBookings = bookings.filter(booking => {
                const bookingDate = new Date(booking.bookingDate);
                const bookingYear = bookingDate.getFullYear();
                const bookingMonth = bookingDate.getMonth();

                const yearMatch = (bookingYear === selectedYear);
                const monthMatch = (selectedMonth === 'all' || bookingMonth === parseInt(selectedMonth));

                return yearMatch && monthMatch;
            });

            updateMonthlyChart(filteredBookings, selectedYear);
            updateDepartmentChart(filteredBookings);
            updateLocationChart(filteredBookings);
            updatePurposeChart(filteredBookings);
        }

        // Function to update monthly usage chart
        function updateMonthlyChart(filteredBookings, selectedYear) {
            const monthlyData = {};
            
            // Initialize months for the selected year
            for (let i = 0; i < 12; i++) {
                const monthKey = `${selectedYear}-${String(i + 1).padStart(2, '0')}`;
                monthlyData[monthKey] = 0;
            }
            
            // Count bookings per month from filtered data
            filteredBookings.forEach(booking => {
                const monthKey = booking.bookingDate.substring(0, 7);
                if (monthlyData.hasOwnProperty(monthKey)) {
                    monthlyData[monthKey]++;
                }
            });
            
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            // Check if a Chart instance already exists
            if (window.monthlyChartInstance) {
                window.monthlyChartInstance.destroy(); // Destroy the old instance
            }
            window.monthlyChartInstance = new Chart(ctx, { // Store the new instance in the window object
                type: 'line',
                data: {
                    labels: ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'],
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                        data: Object.values(monthlyData),
                        borderColor: CHART_COLORS[0], // Use the first color from the palette
                        backgroundColor: CHART_COLORS[0] + '33', // Add transparency
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Function to update department usage chart
        function updateDepartmentChart(filteredBookings) {
            const departmentData = {};
            
            filteredBookings.forEach(booking => {
                departmentData[booking.department] = (departmentData[booking.department] || 0) + 1;
            });
            
            const ctx = document.getElementById('departmentChart').getContext('2d');
            // Check if a Chart instance already exists
            if (window.departmentChartInstance) {
                window.departmentChartInstance.destroy(); // Destroy the old instance
            }
            window.departmentChartInstance = new Chart(ctx, { // Store the new instance in the window object
                type: 'doughnut',
                data: {
                    labels: Object.keys(departmentData).map(key => `${key} (${departmentData[key]} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`), // Add "(number of times)"
                    datasets: [{
                        data: Object.values(departmentData),
                        backgroundColor: CHART_COLORS.slice(0, Object.keys(departmentData).length) // Use colors from the palette
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 12 // Increase font size
                                }
                            }
                        }
                    }
                }
            });
        }

        // Function to update popular room chart
        function updateLocationChart(filteredBookings) {
            const locationData = {};
            
            filteredBookings.forEach(booking => {
                locationData[booking.location] = (locationData[booking.location] || 0) + 1;
            });
            
            const ctx = document.getElementById('locationChart').getContext('2d');
            // Check if a Chart instance already exists
            if (window.locationChartInstance) {
                window.locationChartInstance.destroy(); // Destroy the old instance
            }
            window.locationChartInstance = new Chart(ctx, { // Store the new instance in the window object
                type: 'bar',
                data: {
                    labels: Object.keys(locationData).map(key => `${key} (${locationData[key]} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`), // Add "(number of times)"
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                        data: Object.values(locationData),
                        backgroundColor: CHART_COLORS.slice(0, Object.keys(locationData).length) // Use colors from the palette
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    size: 12 // Increase font size for X-axis
                                }
                            }
                        },
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Function to update purpose of use chart
        function updatePurposeChart(filteredBookings) {
            const purposeData = {};
            
            filteredBookings.forEach(booking => {
                purposeData[booking.purpose] = (purposeData[booking.purpose] || 0) + 1;
            });
            
            const ctx = document.getElementById('purposeChart').getContext('2d');
            // Check if a Chart instance already exists
            if (window.purposeChartInstance) {
                window.purposeChartInstance.destroy(); // Destroy the old instance
            }
            window.purposeChartInstance = new Chart(ctx, { // Store the new instance in the window object
                type: 'pie',
                data: {
                    labels: Object.keys(purposeData).map(key => `${key} (${purposeData[key]} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`), // Add "(number of times)"
                    datasets: [{
                        data: Object.values(purposeData),
                        backgroundColor: CHART_COLORS.slice(0, Object.keys(purposeData).length) // Use colors from the palette
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 12 // Increase font size
                                }
                            }
                        }
                    }
                }
            });
        }

        // Utility function
        function formatThaiDate(dateStr) {
            // Parse the date string into year, month, day components
            const [yearStr, monthStr, dayStr] = dateStr.split('-');
            // Create a Date object using these components.
            // When providing year, month (0-indexed), day, JavaScript creates a local date.
            const date = new Date(parseInt(yearStr), parseInt(monthStr) - 1, parseInt(dayStr)); 
            
            const day = date.getDate();
            const month = date.getMonth();
            const year = date.getFullYear() + 543; // Convert to Buddhist year
            
            const monthNames = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.',
                              '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            
            return `${day} ${monthNames[month]} ${year}`;
        }

        // Modal functions
        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
        }

        function closeBookingModal() {
            document.getElementById('bookingModal').style.display = 'none';
        }

        // Function to show Custom Alert (replaces alert())
        function showCustomAlert(message) {
            const alertModal = document.createElement('div');
            alertModal.id = 'customAlertModal';
            alertModal.className = 'modal';
            alertModal.innerHTML = `
                <div class="modal-content text-center">
                    <div class="text-4xl mb-4 text-red-500">‚ùó</div>
                    <h3 class="text-xl font-bold text-red-600 mb-4">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                    <p class="text-gray-600 mb-6">${message}</p>
                    <button onclick="closeCustomAlert()" class="bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-colors">
                        ‡∏ï‡∏Å‡∏•‡∏á
                    </button>
                </div>
            `;
            document.body.appendChild(alertModal);
            alertModal.style.display = 'block';
        }

        // Function to close Custom Alert
        function closeCustomAlert() {
            const alertModal = document.getElementById('customAlertModal');
            if (alertModal) {
                alertModal.remove();
            }
        }

        // Close modal when clicking outside the modal area
        window.onclick = function(event) {
            const successModal = document.getElementById('successModal');
            const bookingModal = document.getElementById('bookingModal');
            const customAlertModal = document.getElementById('customAlertModal');
            
            if (event.target === successModal) {
                successModal.style.display = 'none';
            }
            if (event.target === bookingModal) {
                bookingModal.style.display = 'none';
            }
            if (event.target === customAlertModal) {
                closeCustomAlert();
            }
        }
    </script>
</body>
</html>
